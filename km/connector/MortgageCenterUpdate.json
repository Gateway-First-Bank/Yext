{
  "$id": "MortgageCenterUpdate",
  "$schema": "https://schema.yext.com/config/km/connector/v4",
  "displayName": "MortgageCenterUpdate",
  "entityTypes": [
    "location"
  ],
  "source": {
    "sourceConfig": {
      "ftpConfig": {
        "protocol": "SFTP",
        "host": "s-6e3385770a6946b9a.server.transfer.us-east-1.amazonaws.com",
        "port": 22,
        "username": "gw-yext-connector",
        "credential": {
          "sshPrivateKey": "${{km/connector.MortgageCenterUpdate.ssh_private_key}}"
        },
        "fileLocation": {
          "exactFilePath": "mortgagecenter.csv"
        },
        "dataFormat": "CSV",
        "config": {
          "csv": {
            "columnDelimiter": ",",
            "hasHeader": true
          }
        }
      }
    },
    "selectors": [
      {
        "type": "COLUMN",
        "header": "_id",
        "column": {
          "header": "_id"
        }
      },
      {
        "type": "COLUMN",
        "header": "|_type",
        "column": {
          "header": "|_type"
        }
      },
      {
        "type": "COLUMN",
        "header": "|_nmls_id",
        "column": {
          "header": "|_nmls_id"
        }
      },
      {
        "type": "COLUMN",
        "header": "|_branch_id",
        "column": {
          "header": "|_branch_id"
        }
      },
      {
        "type": "COLUMN",
        "header": "|_name",
        "column": {
          "header": "|_name"
        }
      },
      {
        "type": "COLUMN",
        "header": "|_address1",
        "column": {
          "header": "|_address1"
        }
      },
      {
        "type": "COLUMN",
        "header": "|_address2",
        "column": {
          "header": "|_address2"
        }
      },
      {
        "type": "COLUMN",
        "header": "|_city",
        "column": {
          "header": "|_city"
        }
      },
      {
        "type": "COLUMN",
        "header": "|_state",
        "column": {
          "header": "|_state"
        }
      },
      {
        "type": "COLUMN",
        "header": "|_zip",
        "column": {
          "header": "|_zip"
        }
      },
      {
        "type": "COLUMN",
        "header": "|_fax",
        "column": {
          "header": "|_fax"
        }
      },
      {
        "type": "COLUMN",
        "header": "|_phone",
        "column": {
          "header": "|_phone"
        }
      }
    ]
  },
  "transforms": [
    {
      "findAndReplace": {
        "inputHeaders": {
          "headers": [
            "_id"
          ]
        },
        "valueToFind": {
          "regex": "^(\\w+)$"
        },
        "replacement": "M-$1"
      }
    },
    {
      "mergeColumns": {
        "inputHeaders": [
          "|_name",
          "|_state"
        ],
        "newColumnHeader": "website",
        "delimiter": "-"
      }
    },
    {
      "fixCapitalization": {
        "inputHeaders": {
          "headers": [
            "website"
          ]
        },
        "cleanOption": "ALL_LOWER"
      }
    },
    {
      "findAndReplace": {
        "inputHeaders": {
          "headers": [
            "website"
          ]
        },
        "valueToFind": {
          "plainText": {
            "value": " ",
            "ignoreCase": false
          }
        },
        "replacement": "-"
      }
    },
    {
      "findAndReplace": {
        "inputHeaders": {
          "headers": [
            "website"
          ]
        },
        "valueToFind": {
          "plainText": {
            "value": "---",
            "ignoreCase": false
          }
        },
        "replacement": "-"
      }
    },
    {
      "findAndReplace": {
        "inputHeaders": {
          "headers": [
            "website"
          ]
        },
        "valueToFind": {
          "plainText": {
            "value": "\u0027",
            "ignoreCase": false
          }
        },
        "replacement": ""
      }
    },
    {
      "findAndReplace": {
        "inputHeaders": {
          "headers": [
            "website"
          ]
        },
        "valueToFind": {
          "plainText": {
            "value": ",",
            "ignoreCase": false
          }
        },
        "replacement": ""
      }
    },
    {
      "addColumn": {
        "newColumnHeader": "website-prefix",
        "columnValue": "https://www.gatewayfirst.com/locations-atms/"
      }
    },
    {
      "mergeColumns": {
        "inputHeaders": [
          "website-prefix",
          "website"
        ],
        "newColumnHeader": "landing-page-url",
        "delimiter": ""
      }
    },
    {
      "addColumn": {
        "newColumnHeader": "Geomodifier-name",
        "columnValue": "Gateway Mortgage"
      }
    }
  ],
  "mappings": [
    {
      "header": "Geomodifier-name",
      "field": "name",
      "subfieldPath": [],
      "clearValueIfBlank": false
    },
    {
      "header": "landing-page-url",
      "field": "websiteUrl",
      "subfieldPath": [
        {
          "name": "url"
        }
      ],
      "clearValueIfBlank": false
    },
    {
      "header": "|_address2",
      "field": "address",
      "subfieldPath": [
        {
          "name": "line2"
        }
      ],
      "clearValueIfBlank": true
    },
    {
      "header": "|_address1",
      "field": "address",
      "subfieldPath": [
        {
          "name": "line1"
        }
      ],
      "clearValueIfBlank": false
    },
    {
      "header": "|_state",
      "field": "address",
      "subfieldPath": [
        {
          "name": "region"
        }
      ],
      "clearValueIfBlank": false
    },
    {
      "header": "|_phone",
      "field": "mainPhone",
      "subfieldPath": [],
      "clearValueIfBlank": true
    },
    {
      "header": "|_fax",
      "field": "fax",
      "subfieldPath": [],
      "clearValueIfBlank": true
    },
    {
      "header": "_id",
      "field": "entityId",
      "subfieldPath": [],
      "clearValueIfBlank": false
    },
    {
      "header": "|_nmls_id",
      "field": "c_nMLS",
      "subfieldPath": [],
      "clearValueIfBlank": false
    },
    {
      "header": "|_city",
      "field": "address",
      "subfieldPath": [
        {
          "name": "city"
        }
      ],
      "clearValueIfBlank": false
    },
    {
      "header": "|_zip",
      "field": "address",
      "subfieldPath": [
        {
          "name": "postalCode"
        }
      ],
      "clearValueIfBlank": false
    }
  ],
  "comprehensiveModeConfig": {
    "comprehensiveSet": "ENTITIES_CREATED_BY_THIS_CONNECTOR",
    "actionOnMissingEntities": "DELETE"
  }
}